(function($){$.fn.modal=function(options){options=$.extend({trigger:"modalTrigger",modals:"div.modal",olayBe:true,olay:{opacity:0.7,background:"#000"},popPosition:{top:"Up",left:"Right"},smallfocuspadding:"7px",animationEffect:"slideDown",animationSpeed:"1000",moveModalSpeed:"400",moveOnScroll:true,resizonwindow:true,docClose:true,closeByKeyboard:"27",close:".closeBtn"},options);var olay;var modals=$(options.modals);var currentModal;var isopen=false;var $this=this;var isOk=false;if(modals.css("zIndex")==="auto"||modals.css("zIndex")==0){modals.css("zIndex",1000)}
var olayBeindex=modals.css("zIndex")-1;if(options.olayBe)
olay=$("<div></div>").css({width:"100%",height:($("body").height()>$(window).height())?$("body").height():"100%",opacity:options.olay.opacity,background:options.olay.background,position:"fixed",top:0,left:0,zIndex:olayBeindex,display:"none"}).appendTo("body");$(options.trigger).bind("click",function(e){e.preventDefault();if($(options.trigger).length>1){getmodal=$(this).attr("href");currentModal=$(getmodal);}else{currentModal=modals;}
openmodal()});$(options.close).bind("click",closemodal);if(options.docClose&&options.olayBe)
olay.bind("click",closemodal);if(options.moveOnScroll)
$(window).bind("scroll",movemodal);if(options.resizonwindow)
$(window).bind("resize",movemodal);if(options.closeByKeyboard>0)
{$("body").keyup(function(e){if(e.which==options.closeByKeyboard){closemodal();}});}
function openmodal(){currentModal.css({top:popTop(options.popPosition.top,currentModal),left:popLeft(options.popPosition.left,currentModal)});if(isopen===false){animationEffects[options.animationEffect]();}else{currentModal.show();}
isopen=true;}
function popTop(methodkey,methodpara){var popTop_={Up:function(e){return 0+$(window).scrollTop();},Content:function(e){return $(window).height()/2-e.outerHeight()/2+$(window).scrollTop();},windowDown:function(e){return $(window).height()-e.outerHeight(true)+$(window).scrollTop();},bodyDown:function(e){return $("body").height()+$(window).scrollTop();}}
if(popTop_[methodkey])
{return popTop_[methodkey](methodpara);}else{return popTop_["Content"](methodpara);}}
function popLeft(methodkey,methodpara){var popLeft_={Left:function(e){return 0+$(window).scrollLeft();},Content:function(e){return $(window).width()/2-e.outerWidth()/2+$(window).scrollLeft();},Right:function(e){return $(window).width()-e.outerWidth(true)+$(window).scrollLeft();}}
if(popLeft_[methodkey])
{return popLeft_[methodkey](methodpara);}else{return popLeft_["Content"](methodpara);}}
var animationEffects={slideDown:function(){if(isOk)return false;if(options.olayBe)
olay.slideDown(options.animationSpeed);currentModal.delay(300).slideDown(options.animationSpeed,function(){isOk=true;});},fadeIn:function(){if(isOk)return false;if(options.olayBe)
olay.fadeIn(options.animationSpeed);currentModal.delay(300).fadeIn(options.animationSpeed,function(){isOk=true;});},movezoom:function(){if(isOk)return false;var currentModalheight,currentModalwidth,$thisTop,$thisLeft,currentModalTop,currentModalLeft;if(options.olayBe)
olay.fadeIn(options.animationSpeed);currentModalheight=currentModal.height();currentModalwidth=currentModal.width();$thisTop=$this.position().top;$thisLeft=$this.position().left;currentModalTop=popTop(options.popPosition.top,currentModal);currentModalLeft=popLeft(options.popPosition.left,currentModal);currentModal.css({top:$thisTop,left:$thisLeft,width:currentModalwidth*0.1,height:currentModalheight*0.1});currentModal.delay(300).stop(false).animate({top:currentModalTop,left:currentModalLeft,width:currentModalwidth,height:currentModalheight},options.animationSpeed,function(){isOk=true;}).show();},movezoomfadeIn:function(){if(isOk)return false;var $thisTop,$thisLeft,smallfocus,currentModalheight,laseposition;$thisTop=$this.position().top;$thisLeft=$this.position().left;currentModalheight=currentModal.height();smallfocus=$("<div></div>").appendTo("body");smallfocus.attr("class",currentModal.prop("class"))
smallfocus.css({width:"10px",height:"1px",padding:options.smallfocuspadding,top:$thisTop,left:$thisLeft,zIndex:(currentModal.css("zIndex")+1)});laseposition=popTop(options.popPosition.top,currentModal);currentModal.css({top:laseposition,left:popLeft(options.popPosition.left,currentModal),height:smallfocus.height()});if(options.olayBe)
olay.fadeIn(options.animationSpeed);smallfocus.delay(400).stop(true).animate({top:laseposition,left:popLeft(options.popPosition.left,smallfocus)},options.animationSpeed,function(){smallfocus.animate({width:currentModal.width(),left:popLeft(options.popPosition.left,currentModal)},options.animationSpeed/2,function(){smallfocus.remove();currentModal.animate({height:currentModalheight},options.animationSpeed*0.8,function(){isOk=true;}).show();})}).show();}}
var closeanimationEffects={slideDown:function(){if(!isOk)return false;isOk=false;modals.fadeOut(100,function(){if(options.olayBe)
olay.slideUp();});},fadeIn:function(){if(!isOk)return false;isOk=false;modals.fadeOut(100,function(){if(options.olayBe)
olay.fadeOut();});},movezoom:function(){if(!isOk)return false;isOk=false;var currentModalheight,currentModalwidth,$thisTop,$thisLeft;$thisTop=$this.position().top;$thisLeft=$this.position().left;currentModalheight=currentModal.height();currentModalwidth=currentModal.width();currentModal.stop(true).animate({top:$thisTop,left:$thisLeft,width:currentModalwidth*0.1,height:currentModalheight*0.1},options.animationSpeed,function(){if(options.olayBe)
olay.fadeOut();currentModal.hide();currentModal.css({width:currentModalwidth,height:currentModalheight})});},movezoomfadeIn:function(){if(!isOk)return false;isOk=false;var currentModalheight,currentModalwidth;currentModalheight=currentModal.height();currentModalwidth=currentModal.width();currentModal.animate({height:0,opacity:0},options.animationSpeed*0.9,function(){if(options.olayBe)
olay.fadeOut(options.animationSpeed/4);currentModal.css({width:currentModalwidth,height:currentModalheight,opacity:1,display:"none"})})}}
function movemodal(){setTimeout(function(){if(!isOk)return false;modals.stop(true).animate({top:popTop(options.popPosition.top,modals),left:popLeft(options.popPosition.left,modals)},options.moveModalSpeed);},400);}
function closemodal(){isopen=false;closeanimationEffects[options.animationEffect]();}}})($)